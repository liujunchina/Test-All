window.GLOBAL={},GLOBAL.checkmail=function(t){var e=/^[\w][\.\w_-]+[\w]@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/,o=e.test(t);return o?!0:!1},GLOBAL.lazyLoad={scrollLazyLoad:function(t){var e=$(t);e.lazyload({threshold:100,effect:"fadeIn",failure_limit:60,skip_invisible:!1})}},GLOBAL.Search=function(t,e){var o,n,i=t,a=e;return o=$.trim(i.val()),o=o.replace(/\*/g,"~~"),o=o.replace(/\|/g,"]]"),o=o.replace(/\=/g,"(("),o=o.replace(/\"/g," "),o=o.replace(/\</g,"))"),o=o.replace(/\>/g,")))"),o=o.replace(/\?/g,"!!!"),o=o.replace(/\+/g,"__"),o=o.replace(/\-/g,"^^"),o=o.replace(/\//g,".."),o=o.replace(/\\/g,"..."),o=o.replace(/\%/g,"!!"),o=o.replace(/\#/g,"~~~"),o=o.replace(/\>/g,"___"),o=o.replace(/\</g,"^^^"),o=o.replace(/\"/g,"[["),o=o.replace(/\$/g,"[[["),o=o.replace(/\s+/g,"-"),o=o.toLowerCase(),o=o.replace(/\b\w+\b/g,function(t){return t}),o.length<1?i.focus():(o=o.replace("%20","-"),n=a.val(),window.location.href=DOMAIN+"/s/"+o+"/"),!1},GLOBAL.login={info_check:function(t){$.ajax({url:DOMAIN+"/fun/?act=info_check",type:"POST",dataType:"json"}).done(function(e){var o=e.firstname,n=e.cart_items,i=$(".isLogin"),a=$(".isNoLogin"),s=$("#js_topCartNum"),r=$("#js_leftCartNum");o?(a.hide(),i.show(),i.find(".js_userName").html(o)):(a.show(),i.hide()),n&&(s.html(n),r.html(n)),t&&"function"==typeof t&&t(e)})},isLogin:function(){$("#isNoLogin").hide(),$("#isLogin").show()}},GLOBAL.cart={getCartObj:function(t){"undefined"==typeof CART?$LAB.script("cart.min.js?2015101002").wait(function(){t.call(CART)}):t.call(CART)},showMinCart:function(t){var e=this,o=$("#js_minCart"),n=!(o.children().length>0);clearTimeout(e.minCartTimer),o.stop(!0,!0).fadeIn(300),e.minCartTimer=setTimeout(function(){o.hasClass("mouse-over")||$("#js_topCartBtn").hasClass("mouse-over")?e.showMinCart():o.stop(!0,!0).fadeOut(300)},4e3),(n||void 0!=t)&&this.updateMinCart(t)},updateMinCart:function(t){this.getCartObj(function(){this.init(!0,"js_minCart",t)})},cartItems:function(){},getGoodsNumInput:function(){return void 0==this.goodsNumInput&&(this.goodsNumInput=$("#js_qty")),this.goodsNumInput},getAddToCartBtn:function(){return void 0==this.addToCartBtn&&(this.addToCartBtn=$("#js_addCart")),this.addToCartBtn},getFixedAddToCartBtn:function(){return void 0==this.fixedAddToCartBtn&&(this.fixedAddToCartBtn=$("#js_aAddCart")),this.fixedAddToCartBtn},getBuyNowBtn:function(){return void 0==this.buyNowbtn&&(this.buyNowbtn=$("#js_buyBtn")),this.buyNowbtn},getFixedBuyNowBtn:function(){return void 0==this.fixedBuyNowbtn&&(this.fixedBuyNowbtn=$("#js_aBuyBtn")),this.fixedBuyNowbtn},getOverAmountTip1:function(){return void 0==this.overAmountTip1&&(this.overAmountTip1=$("#js_overAmountTip_1")),this.overAmountTip1},getOverAmountTip2:function(){return void 0==this.overAmountTip2&&(this.overAmountTip2=$("#js_overAmountTip_2")),this.overAmountTip2},getGoodsPrice:function(){return void 0==this.goodsPrice&&(this.goodsPrice=$("#js_currentPrice").attr("value")-0),this.goodsPrice},getGoodsBtnCollection:function(){return this.getAddToCartBtn().add(this.getBuyNowBtn()).add(this.getFixedAddToCartBtn()).add(this.getFixedBuyNowBtn())},setStatusMsg:function(t){t>500&&1e3>t?(this.getOverAmountTip1().show(),this.getOverAmountTip2().hide(),this.getBuyNowBtn().removeClass("disabled"),this.getFixedBuyNowBtn().removeClass("disabled")):t>1e3?(this.getOverAmountTip1().hide(),this.getOverAmountTip2().show(),this.getBuyNowBtn().addClass("disabled"),this.getFixedBuyNowBtn().addClass("disabled")):(this.getOverAmountTip1().hide(),this.getOverAmountTip2().hide(),this.getBuyNowBtn().removeClass("disabled"),this.getFixedBuyNowBtn().removeClass("disabled"))},updateGoodsNumber:function(t){var e=999999;t-=0,t=t>e?e:0>=t?1:t,this.getGoodsNumInput().val(t),this.getGoodsBtnCollection().attr("num",t),this.setStatusMsg(t*this.getGoodsPrice())},add:function(){var t=this.getGoodsNumInput();this.updateGoodsNumber(Number(t.val())+1)},reduce:function(){var t=this.getGoodsNumInput(),e=Number(t.val())-1;e>=1&&this.updateGoodsNumber(e)},input_quantity:function(){var t=this,e=t.getGoodsNumInput().val();clearTimeout(this.inputTimer),this.inputTimer=setTimeout(function(){return isNaN(e)?(layer.open({btn:["确定"],content:"请输入正确的数字",end:function(){t.getGoodsNumInput().focus()}}),t.updateGoodsNumber(1),!1):void t.updateGoodsNumber(e)},200)},addcart:function(t,e){e=e||function(){};var o=$(t),n=this,i=o.attr("gid"),a=o.attr("num")-0,s=o.hasClass("buyNow")?1:0;return o.hasClass("disabled")?!1:void $.ajax({url:"/m-flow-a-add_to_cart.html",type:"POST",dataType:"json",data:{goods_id:i,goods_num:a,express:s}}).done(function(t){var i=$("#js_shopcart");if(0!==t.status)layer.open({btn:["确定"],content:t.msg});else{if(1==s&&(window.location.href=DOMAIN_CART+"/m-flow-a-checkout.html"),o.hasClass("addToCart")){var a=$(window).scrollTop();if(window.requestAnimationFrame){var r=$('<img class="u-flyer" src="'+o.data("proimg")+'"/>');r.fly({start:{left:o.offset().left,top:o.offset().top-a},end:{left:i.offset().left,top:i.offset().top-$(window).scrollTop(),width:20,height:20},onEnd:function(){i.find(".num").text(t.data.cart_num),r.remove()}})}else i.find(".num").text(cart_items)}n.showMinCart(t),e()}})},addCartAjaxFn:function(t,e){var o=t.goods_id,n=t.goods_num,i=this;$.ajax({type:"POST",url:"/m-flow-a-add_to_cart.htm",data:{goods_id:o,goods_num:n},dataType:"jsonp",success:function(t){i.showMinCart(t),e&&"function"==typeof e&&e(t)}})}},GLOBAL.setFLoatBoxPosition=function(){var t=$(window),e=$(".js_mainBgWrap").offset().top+46,o=$("#rightBar"),n=$("#leftBar"),i=66,a=t.width();t.scrollTop()<=e-i?(o.css({position:"absolute",top:e}).show(),a>=1440&&n.css({position:"absolute",top:e}).show()):(o.css({position:"fixed",top:i}).show(),a>=1440&&n.css({position:"fixed",top:i}).show())},GLOBAL.otherGlobal={requestAnimationFrame:function(){for(var t=0,e=["ms","moz","webkit","o"],o=0;o<e.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[e[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[o]+"CancelAnimationFrame"]||window[e[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var o=(new Date).getTime(),n=Math.max(0,16-(o-t)),i=window.setTimeout(function(){e(o+n)},n);return t=o+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})},supports:function(t){var e=document.createElement("div"),o="Khtml O Moz Webkit".split(" "),n=o.length;if(t in e.style)return!0;if("-ms-"+t in e.style)return!0;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(o[n]+t in e.style)return!0;return!1},getTime:function(t){if(t>0){var e=t,o=Math.floor(e/60),n=Math.floor(o/60),i=o%60,a=e%60;return 10>n&&(n="0"+n),10>i&&(i="0"+i),10>a&&(a="0"+a),{hours:n,minutes:i,seconds:a}}return!1},getTimeWithDay:function(t){if(t>0){var e=t,o=Math.floor(e/60),n=Math.floor(o/60),i=Math.floor(n/24),a=n%24,s=o%60,r=e%60;return 10>i&&(i="0"+i),10>a&&(a="0"+a),10>s&&(s="0"+s),10>r&&(r="0"+r),{days:i,hours:a,minutes:s,seconds:r}}return!1},addCookie:function(t){t=$.extend({name:"",value:"",expiresHours:72,domain:COOKIESDIAMON,path:"/"},t);var e=t.name+"="+escape(t.value)+";path="+t.path+";domain="+t.domain;if(t.expiresHours>0){var o=new Date;o.setTime(o.getTime()+3600*t.expiresHours*1e3),e=e+"; expires="+o.toGMTString()}document.cookie=e},getCookie:function(t){for(var e=document.cookie,o=e.split("; "),n=0;n<o.length;n++){var i=o[n].split("=");if(i[0]==t)return i[1]}return""},deleteCookie:function(t){var e=new Date;e.setTime(e.getTime()-1e4),document.cookie=t+"=v; expires="+e.toGMTString()},inputLimitedDigital:function(t){t.value=t.value.replace(/\D/g,"")},inputToUpperCase:function(t){t.value=t.value.toUpperCase()},myPlaceholder:{check:function(){return"placeholder"in document.createElement("input")},init:function(t,e){return this.$jqSelector=t,!t.length>0?!1:void(!this.check()&&this.create(e))},showHolder:function(t,e){e.show()},hideHolder:function(t,e){e.hide()},create:function(t){var e=this;e.$jqSelector.each(function(){var o=$(this),n=o.attr("placeholder");o.wrap($("<span></span>").css({display:"block",position:"relative",zoom:"1",border:"none",background:"none",padding:"none",margin:"none"}));var i=t||o.outerHeight(!0),a=o.css("padding-left"),s=$("<span></span>").text(n).css({position:"absolute",left:0,top:0,height:i,lineHeight:i+"px",paddingLeft:a,color:"#aaa",fontSize:"14px"}).appendTo(o.parent());""!=o.val()&&s.hide(),o.focusin(function(){s.hide()}).focusout(function(){""==o.val()&&e.showHolder(o,s)}),s.on("mousedown",function(){e.hideHolder(o,s),o.focus()}),"undefined"==typeof document.addEventListener?o.on("propertychange",function(){""==o.val()?e.showHolder(o,s):e.hideHolder(o,s)}):o.on("input",function(){""==o.val()?e.showHolder(o,s):e.hideHolder(o,s)})})}},minCart:function(){var t=$("#js_minCart");$("#js_topCartBtn").on("mouseenter",function(){GLOBAL.cart.showMinCart(),$(this).addClass("mouse-over")}).on("mouseleave",function(){$(this).removeClass("mouse-over")}),t.on("mouseenter",function(){t.addClass("mouse-over")}).on("mouseleave",function(){clearTimeout(GLOBAL.cart.minCartTimer),t.removeClass("mouse-over").fadeOut(300)})},navEvent:function(){var t=$("#funcTab");t.on("mouseenter",".js_category",function(){var t=$(this).find(".js_subNav");0!=t.length&&(t.show().addClass("img-loaded"),t.hasClass("img-loading")||t.find(".js_subNavImg").each(function(){$(this).attr({src:$(this).data("src")})}))}),t.on("mouseleave",".js_category",function(){var t=$(this).find(".js_subNav");0!=t.length&&t.hide()})}},function(t){t.fn.toTop=function(e){return e=t.extend({speed:200},e),this.each(function(){t(this).on("click",function(){t("html, body").animate({scrollTop:0},e.speed)})}),this}}(jQuery),function(t){t.fn.delayKeyup=function(e,o){var n=0;return t(this).on("keyup",function(t){clearTimeout(n),e&&"function"==typeof e?n=setTimeout(function(){e(t)},o):alert("Your callback is not valid")}),t(this)}}(jQuery),$(function(){GLOBAL.otherGlobal.requestAnimationFrame(),GLOBAL.otherGlobal.minCart(),GLOBAL.otherGlobal.navEvent(),layer.config({skin:"layer-ext-moon",extend:"skin/moon/style.css"});var t;$(document).ajaxStart(function(){t=layer.msg("努力加载中",{icon:16,scrollbar:!0,shade:[.3,"#000"],time:15e3})}).ajaxComplete(function(){setTimeout(function(){layer.close(t)},500)}),$.ajaxSetup({global:!1,timeout:1e4}),$(".js_loading").on("click",function(){layer.open({type:2,shadeClose:!1})}),GLOBAL.login.info_check(),GLOBAL.lazyLoad.scrollLazyLoad($("img[data-original]")),$("#rightBar,#leftBar").length>0&&$(".js_mainBgWrap").length>0&&($(window).scroll(function(){GLOBAL.setFLoatBoxPosition()}),GLOBAL.setFLoatBoxPosition(),$(window).resize(function(){var t=$(this),e=$("#leftBar"),o=t.width();setTimeout(function(){o>=1600?e.show():e.hide()},500)})),$("#rightBar").length>0&&$(".js_scrollToTop").click(function(){$("html,body").animate({scrollTop:0},500)})}),function(){$(".js_topSearchBtn").parent().find("input[name='keyword']").on("keydown",function(t){var e=$(this);13===t.keyCode&&e.parent().find(".js_topSearchBtn").trigger("click")}),$(".js_topSearchBtn").click(function(){var t=$(this),e=t.parent().find("input[name='keyword']"),o=t.parent().find("input[name='category']");GLOBAL.Search(e,o)}),function(){function t(){var t=i.val();t?$.ajax({type:"GET",url:DOMAIN+"/temp/skin1/dist/minjs/demo_search.json",data:{keyword:t},dataType:"json",beforeSend:function(){$("#js_seachLoading").show()},success:function(t){$("#js_seachLoading").hide(),"fail"!=t.res?(n.html(t.res),e()):o()}}):o()}function e(){n.show();var t=n.find("li"),e=t.size(),a=(i.val(),0);n.find("li").on("mouseover",function(t){t.preventDefault();var e=$(this);a=e.index()+1,e.siblings("li").find("a").removeClass("current"),e.find("a").addClass("current")}),$(document).on("keydown",function(s){if(38==s.keyCode)a--,0>=a&&(a=e);else{if(40!=s.keyCode)return 27==s.keyCode?void o():void 0;a++,a>e&&(a=1)}var r=t.eq(a-1);n.find("li").find("a").removeClass("current"),r.find("a").addClass("current"),i.val(r.find("span").text())})}function o(){var t=i.val();t||n.html(a),n.hide(),$(document).off("keydown")}var n=$("#js_seachComplete"),i=$("#js_topSearch"),a=n.html();$(document).on("click",function(){o()}),$("#js_topSearch,#js_seachComplete").on("click",function(t){t.stopPropagation(),e()}),i.delayKeyup(function(e){37!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&40!=e.keyCode&&116!=e.keyCode&&27!=e.keyCode&&t()},300),n.on("click","li a",function(){var t=$(this);return i.val(t.find("span").text()),o(),!1})}()}(),function(){function t(t){var o=$(t.target),n=$(window).scrollTop(),i=$("#js_shopcart");if(o.hasClass("disabled"))return!1;if(window.requestAnimationFrame){var a=$('<img class="u-flyer" src="'+o.data("proimg")+'"/>');a.fly({start:{left:o.offset().left,top:o.offset().top-n},end:{left:i.offset().left,top:i.offset().top-$(window).scrollTop(),width:20,height:20},onEnd:function(){GLOBAL.cart.addCartAjaxFn({goods_id:o.data("goods_id"),goods_num:1},e),a.remove()}})}else GLOBAL.cart.addCartAjaxFn({goods_id:o.data("goods_id"),goods_num:1},e)}function e(t){var e=t.status,o=t.cart_items;if(e)alert(t.msg);else{var n=$("#js_shopcart"),i=$("#js_topCartNum");n.find(".num").text(o),i.text(o)}}$(".js_addToCart").on("click",t)}();