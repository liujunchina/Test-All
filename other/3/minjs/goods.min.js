function setPositionSaleCookie(){var t=location.search;if(t&&0==t.indexOf("?i=")){var e=t.match(/^\?i=(\d{5}_\d+)$/),i=$.cookie("position_sale");if(e||(e=t.match(/^\?i=(00004&s=\d{5})$/),e&&(e=[null,e[1].replace("&s=","_")])),e){var a=e[1],s=$("#hidden-goodsId").val()+"_";if(i)if(("|"+i).indexOf(s)>-1){for(var o=i.split("|"),n=0,r=o.length;r>n;n++)if(o[n].indexOf(s)>-1){o[n]=s+a;break}i=o.join("|")}else i+="|"+s+a;else i=s+a;$.cookie("position_sale",i,{expires:1,path:"/",domain:COOKIESDIAMON})}}}!function(){function t(){var t=$("#hidden-goodsId").val(),e=6,i="EOT",a="browserHistories3",s=$("#hidden-history").val(),o=$.cookie(a);if(t&&s){var n=t+".htm",r=[];if(o){var r=o.split(i);if(o.indexOf(n)>-1)for(var l=0,d=r.length;d>l;l++)if(r[l].indexOf(n)>-1){r.splice(l,1);break}}r.unshift(s),r=r.length>e?r.slice(0,e):r,$.cookie("browserHistories2","",{expires:-1,path:"/",domain:COOKIESDIAMON}),$.cookie(a,r.join(i),{expires:7,path:"/",domain:COOKIESDIAMON})}}function e(t){var e=$("#js_jqzoom"),a=$("#js_n_thumbImg"),s=$("#js_revThumb_img"),o=e.find("img");$img=t.find("img");var n=new Image;e.append('<span class="loading"></span>'),$(n).load(function(){e.find("span.loading").remove(),o.attr({src:$img.data("normal-img"),jqimg:$img.data("big-img")});n.width,n.height;2==$("#pic_from").val()&&i&&(e.zoom(),e.addClass("cursorZoomIn"),e.click(function(){var t=e.find("img").attr("jqimg"),i=($(window).height(),$(window).width());$("html").css("overflow","hidden"),$(document.body).append('<div id="full_mode" class="cursorZoomOut"><img src='+t+"></div>"),a.addClass("n_thumbImg_in_fixed");var o=$("#full_mode"),n=o.find("img");o.append('<div id="fullClose" title="close">close</div>'),n.css("marginLeft",i/2-n.width()/2),s.hide(),a.find("li").each(function(t){var e=new Image;e.src=$(this).children("img").data("big-img"),e.onload=function(){e.width<1e3&&a.find("li").eq(t).hide()}}),o.on("click",function(){$(this).remove(),a.removeClass("n_thumbImg_in_fixed"),$("html").css("overflow","scroll"),s.show(),a.find("li").show()}),$("#js_n_thumbImg").find("li").on("mouseenter",function(){n.attr("src",$(this).find("img").data("big-img"))})}),i=!1)}),n.src=$img.data("normal-img"),t.addClass("on").siblings("li").removeClass("on")}var i=!0;$("#js_n_thumbImg").on("mouseover","li",function(){var t=$(this);t.hasClass("video")||e(t)}),$("#js_n_thumbImg").find("li:first()").trigger("mouseover"),$("#js_n_thumbImg").on("click","li.video",function(){var t=$(this),e={area:["590px","380px"],offset:[($(window).height()-380)/2+"px","50%"],closeBtn:!1,page:{html:'<iframe width="590" height="380" src="//www.youtube.com/embed/'+t.find("img").data("video-url")+'" frameborder="0" allowfullscreen></iframe>'}};GLOBAL.PopObj.openPop(e)}),$("#js_n_thumbImg").find("ul.js_scrollableDiv").find("li").length>3&&$("#js_n_thumbImg").find(".n_thumbImg_item").jCarouselLite({btnNext:"#js_spec-backward",btnPrev:"#js_spec_forward",vertical:!0,visible:3}),$("#js_revThumb_img").click(function(){var t,e=704,i=935,a=$(window).height();a>e?t=e:(t=a,i+=20);var s={area:[i+"px",t+"px"],offset:[($(window).height()-t)/2+"px","50%"],iframe:{src:$(this).find("a").data("uid")}};return GLOBAL.PopObj.iframe(s),!1}),$(".js_property_secelt").on("change",function(){GLOBAL.cart.change_same_goods(this)}),$(".addToFavBtn").click(function(){var t=$(this),e={url:t.attr("data-src"),rebackPage:window.location.href,top:t.find("i").offset().top,left:t.find("i").offset().left};return GLOBAL.login.isLogin(GLOBAL.addTofavorite,e),t.addClass("addToFavBtnOn"),!1}),$("#js_goodRevieList").on("click","div.js_reviews_img a",function(){var t={area:["810px","490px"],offset:[($(window).height()-490)/2+"px","50%"],iframe:{src:$(this).data("uid")+"?index="+$(this).index()}};return GLOBAL.PopObj.iframe(t),!1}),$("#js_goodRevieList").on("click","div.js_reviews_video a",function(){var t=$(this),e={area:["590px","380px"],offset:[($(window).height()-380)/2+"px","50%"],closeBtn:!1,page:{html:'<iframe width="590" height="380" src="//www.youtube.com/embed/'+t.data("video")+'" frameborder="0" allowfullscreen></iframe>'}};return GLOBAL.PopObj.openPop(e),!1}),t(),$(".js_size_btn").click(function(){var t=$(this),e=t.parent().find(".js_size"),i=t.parent().find(".js_size_show"),a=t.data("unit");/^([1-9]\d*|0){1,3}$/.test($.trim(e.val()))?i.val("inch"==a?(2.54*e.val()).toFixed(2):(e.val()/2.54).toFixed(2)):(i.val("0.00"),e.val(""))})}(),function(){function t(t,e,i){var a=$(t),s=$(e),o=$(i);$(window).resize(function(){s.css({width:o.width(),left:o.offset().left,top:0}),a.css("fixed"==a.css("position")?{right:$(window).width()-o.offset().left-o.width()}:{right:0})}),$(window).scroll(function(){var t=$(this),e=t.scrollTop(),i=o.height();e>o.offset().top?(s.css({position:"fixed",width:o.width(),left:o.offset().left,top:0}),$(".js_p_infoBlack").each(function(t){var e=$(this).offset().top;s.find("li").eq(t).data("s_top",e)}),s.find("li").each(function(){var t=$(this);t.data("s_top")<e+90&&1!=t.parent("ul").data("isClick")&&t.addClass("on").siblings("li").removeClass("on")})):s.css({position:"static",width:o.width(),left:o.offset().left,top:0}),a.css(e>s.parent().outerHeight(!0)+o.offset().top?e-o.offset().top+a.height()-i<0?{position:"fixed",right:$(window).width()-o.offset().left-o.width(),bottom:"auto",top:"40px"}:{position:"absolute",right:"0",top:"auto",bottom:"0"}:{position:"absolute",right:"0",bottom:"auto",top:"0"})})}t("#js_newGoods","#js_pro_nav","#js_proMain"),$("#js_pro_nav").each(function(){var t=$(this);t.css({backgroundColor:"#fff",zIndex:30}),t.find("li").click(function(){var t=$(this),e=t.index(),i=$(".js_p_infoBlack").eq(e).offset().top;t.data("s_top",i),t.addClass("on").siblings("li").removeClass("on"),t.parent("ul").data("isClick",1),$("body,html").stop().animate({scrollTop:t.data("s_top")-40},500,function(){t.parent("ul").data("isClick",0)})})})}(),function(){GLOBAL.Untime=function(t){this.timeBox=t,this.cutTime=unescape(t.data("time")).split(" "),this._bland="",this.d="",this.msec=arguments[2]},GLOBAL.Untime.prototype.ini=function(){var t,e,i=this,a=this.cutTime;a.length>1&&(t=a[0].split("/"),e=a[1].split(":"),i.d=new Date(t[2],t[1]-1,t[0],e[0],e[1]),i.setCutTime(i.d))},GLOBAL.Untime.prototype.n8=function(t){return 10>t?"0"+t.toString():t.toString()},GLOBAL.Untime.prototype.n3=function(t){return 10>t?"00"+t.toString():100>t?"0"+t.toString():t.toString()},GLOBAL.Untime.prototype.setCutTime=function(t){var e,i,a,s,o,n=this,r=new Date,l=r.getHours()-r.getUTCHours();o=t.getTime()-r.getTime()+3600*(l+7)*1e3,o>0?(s=n.n3(o%1e3),o=(o-o%1e3)/1e3,a=n.n8(o%60),o=(o-o%60)/60,i=n.n8(o%60),o=(o-o%60)/60,e=n.n8(o%24),o=(o-o%24)/24,n.timeBox.html(1==this.msec?o>0?o+"<span>"+jsLg.day+"</span> "+e+":"+i+":"+a:e+":"+i+":"+a:o>0?o+"<span>"+jsLg.day+"</span> "+e+":"+i+":"+a+":"+s:e+":"+i+":"+a+":"+s),n._bland=setTimeout(function(){n.setCutTime(t)},1)):(n.timeBox.html("00 : 00 : 00 : 00"),n._bland&&clearTimeout(n._bland))};var t=new GLOBAL.Untime($("#time_coutDown"));t.ini()}(),function(){$("#InquiryBox").validate({rules:{txtPrice:{required:!0,maxlength:20},txtQuantity:{required:!0,maxlength:10},txtDelDay:{required:!0,maxlength:60},txtTrueName:{required:!0,maxlength:50},txtPhone:{required:!0,maxlength:30},txtEMail:{required:!0,maxlength:60,email:!0},txtMessage:{required:!0,maxlength:300,minlength:6},verifycode:{required:!0,maxlength:4}},messages:{txtPrice:{required:jsLg.inquiry.txtPrice},txtQuantity:{required:jsLg.inquiry.txtQuantity,rangelength:jQuery.format(jsLg.formMsg.Enter_at_least)},txtDelDay:{required:jsLg.inquiry.txtDelDay,rangelength:jQuery.format(jsLg.formMsg.Enter_at_least)},txtTrueName:{required:jsLg.inquiry.txtTrueName,rangelength:jQuery.format(jsLg.formMsg.Enter_at_least)},txtPhone:{required:jsLg.inquiry.txtPhone,rangelength:jQuery.format(jsLg.formMsg.Enter_at_least)},txtEMail:{required:jsLg.inquiry.txtEMail,email:jsLg.formMsg.email_require_msg,rangelength:jQuery.format(jsLg.formMsg.Enter_at_least)},txtMessage:{required:jsLg.inquiry.txtMessage,minlength:jQuery.format(jsLg.formMsg.Enter_at_least)},verifycode:{required:jsLg.formMsg.required,maxlength:jsLg.formMsg.Enter_at_least}},submitHandler:function(){$.post("/"+JS_LANG+"m-inquiry-method-ajax.htm?"+$("#goods_id").val(),$("#InquiryBox").serialize(),function(t){var e={msg:"",typeTag:0};"ok"==t?(e.msg=jsLg.inquiry.success,GLOBAL.PopObj.alert(e),$("#InquiryBox").find("table").find("input").val(""),$("#txtMessage").val(""),$("#InquiryBox").find("label.checked").remove()):(e.msg=t,GLOBAL.PopObj.alert(e)),$("#refresh-verifycode").trigger("click")})},errorPlacement:function(t,e){e.parent().find("label.checked").remove(),t.appendTo(e.parent())},success:function(t){t.remove()}}),$("#refresh-verifycode").click(function(){var t=$("#img-verifycode");t.attr("src",t.attr("data-src")+"&"+Math.random())})}(),function(){function t(t,e,i){this.item=$(t),this.themeStr=i,this.r_Box=$(e),this.datas={"default":$.trim(this.r_Box.html()),small:"",suitable:"",large:""}}t.prototype.ini=function(){var t=this;$(t.item).click(function(){var e=this.getAttribute("data-cur"),i=-1,a=this.getAttribute("data-num");return a-0?(1!=e?($.each(t.item,function(t,e){e.setAttribute("data-cur",0)}),$(t.item).find(t.themeStr).each(function(t,e){$(e).removeClass("on")}),i=this.getAttribute("data-type"),i=$.isNumeric(i-0)?i:-1,this.setAttribute("data-cur",1),$(this).find(t.themeStr).addClass("on")):(this.setAttribute("data-cur",0),$(this).find(t.themeStr).removeClass("on")),t.showHtml(i),!1):!1})},t.prototype.showHtml=function(t){var e,i="default",a=this;switch(t-0){case-1:i="default";break;case 2:i="small";break;case 0:i="suitable";break;case 1:i="large"}e=$.trim(this.datas[i]),e?this.r_Box.html(e):this.getData(t,function(t){a.datas[i]=t,a.r_Box.html(t)})},t.prototype.getData=function(t,e){var i="";this.r_Box.append('<div id="loading"></div>'),$.ajax({url:document.URL,type:"GET",data:{itemPropertyIndex:t}}).done(function(t){i=$.trim(t),e&&$.isFunction(e)?e(i):""})};var e=new t("#js_reviewTheme li","#js_goodRevieList",".js_rateItem");e.ini()}(),function(){function t(t,e){this.btnWrap=$(t),this.table=this.btnWrap.closest(".chartContainer").find(e),this.tabel_unit=this.table.data("unit")}t.prototype={ini:function(){var t=this,e=t.btnWrap;e.on("click","a",function(){var e,i=$(this);i.hasClass("active")||(e=i.data("unit"),t.changeCell(e),i.addClass("active").siblings().removeClass("active"))}).find("a:eq(0)").trigger("click")},changeCell:function(t){var e=this.table.find(".unit-change"),i=this;if("inch"==t){var a=this.tabel_unit,s="cm"==a?.3937:"mm"==a?.03937:0;$.each(e,function(t,e){i.changeToIn($(e),$(e).data("orig"),s)})}else $.each(e,function(t,e){$(e).html($(e).data("orig"))})},changeToIn:function(t,e,i){var a=Math.round(e*i*100)/100;$(t).html(a.toFixed(2))}},$(".js_unit-switcher").each(function(e,i){var a=new t($(i),".js_datasource");a.ini()}),$(".js_table-switcher").on("click","a",function(){$(this).hasClass("active")||($(this).addClass("active").siblings().removeClass("active"),$(".chartContainer").eq($(this).index()).show().siblings(".chartContainer").hide())})}(),setPositionSaleCookie(),function(){function t(){this.curColor=$.trim($("#js_property_color").find(".selected").find("a").attr("title")),this.curSize=$.trim($("#js_property_size").find(".selected").find("a").attr("title")),this.datas=ColorSize,this.usefulColor={},this.usefulSize={},this.ini()}t.prototype.getUsefulData=function(){for(var t=this,e=0,i=this.datas.length;i>e;e++){if(this.datas[e].size==this.curSize&&0==this.datas[e].isSale){var a=this.datas[e].color;t.usefulColor[a]=1}if(this.datas[e].color==this.curColor&&0==this.datas[e].isSale){var a=this.datas[e].size;t.usefulSize[a]=1}}},t.prototype.setStyle=function(){var t=$("#js_property_color").find("li"),e=$("#js_property_size").find("li"),i=this;return $.trim(this.curSize).length?($.each(t,function(t,e){var a=$(e);1!=i.usefulColor[$.trim(a.find("a").attr("title"))]?a.addClass("product_out"):a.removeClass("product_out")}),void $.each(e,function(t,e){var a=$(e);1!=i.usefulSize[$.trim(a.find("a").attr("title"))]?a.removeClass("selected ").addClass("product_out"):a.removeClass("product_out")})):($("#js_property_size").closest("li").hide(),!1)},t.prototype.getGotToNewGoodsId=function(t,e){for(var i=0,a=this.datas.length;a>i;i++)if(this.datas[i].size==e&&this.datas[i].color==t&&0==this.datas[i].isSale)return this.datas[i].goodsId},t.prototype.gotoNewPage=function(t){window.location.href="/"+JS_LANG+"product"+t+".html"},t.prototype.ini=function(){that=this,this.getUsefulData(),this.setStyle(),$("#js_property_color").on("click","li",function(){var t=$(this),e=$("#new_addcart"),i=$("#js_property_size").parent();if(t.siblings("li").removeClass("selected"),t.addClass("selected"),that.curColor=$.trim(t.find("a").attr("title")),delete that.usefulColor,delete that.usefulSize,that.usefulColor={},that.usefulSize={},that.getUsefulData(),that.setStyle(),$.trim(that.curSize).length)if(!t.hasClass("product_out")&&$("#js_property_size").find(".selected").length){var a=that.getGotToNewGoodsId(that.curColor,that.curSize);e.attr("gid","newGoodId"),that.gotoNewPage(a)}else e.attr("gid",""),i.addClass("hl-bg");else{for(var a="",s=0,o=that.datas.length;o>s;s++)if(that.datas[s].color==that.curColor){a=that.datas[s].goodsId;break}that.gotoNewPage(a)}}),$("#js_property_size").on("click","li",function(){var t=$(this),e=$("#new_addcart"),i=$("#js_property_size").parent();if($("#js_property_size").hasClass("disabled"))return!1;if(t.hasClass("product_out"))return!1;t.siblings("li").removeClass("selected"),t.addClass("selected"),that.curSize=$.trim(t.find("a").attr("title")),delete that.usefulColor,delete that.usefulSize,that.usefulColor={},that.usefulSize={},that.getUsefulData(),that.setStyle(),i.removeClass("hl-bg");var a=that.getGotToNewGoodsId(that.curColor,that.curSize);e.attr("gid","newGoodId"),that.gotoNewPage(a)})},$(".js_property_secelt_Box").find(".choose_wrap").length&&new t,$("#js_openPop").click(function(){GLOBAL.PopObj.openPop({offset:[($(window).height()-210)/2+"px","50%"],page:{dom:"#js_popHelp"}})})}();