function setNewUrl(a){var b=window.location.href,c=b.search(/goods_id=/)-0+"goods_id=".length,d=b.search(/&ids=/),e=b.replace(new RegExp(b.slice(c,d)),a);window.location.href=e}$(".prev_goods,.next_goods").click(function(){layer.load(0),window.location.href=$(this).attr("href")}),$("#js_gf_outStock").click(function(){var b=$(this).prop("href");return window.top.location.href=b,!1}),$(".albumList").mCustomScrollbar({horizontalScroll:!0,theme:"dark"}),$("div.albumList").on("click","li",function(){var d,b=$(this),c=$("#js_gf_img");if(b.hasClass("video"))c.html('<iframe width="430" height="430" src="//www.youtube.com/embed/'+b.find("img").data("bigsrc")+'" frameborder="0" allowfullscreen></iframe>');else{d=layer.load(0);var e=new Image;e.onload=function(){c.html('<img src="'+e.src+'" />'),layer.close(d)},e.src=b.find("img").data("bigsrc")}return!1}),$(".js_property_secelt").children(".card_attr").on("click",function(){var a=parseInt(this.value);a>0&&setNewUrl(a)}),$(".js_property_secelt").on("change",function(){var a=parseInt(this.value);a>0&&setNewUrl(a)}),$("#js_input_quantity").on("keyup",function(){GLOBAL.cart.input_quantity(this)}),$("a.btn_add").on("click",function(){GLOBAL.cart.add()}),$("a.btn_reduce").on("click",function(){GLOBAL.cart.reduce()}),$("#new_addcart").click(function(){GLOBAL.cart.addcart(this,0,function(){})}),$(".addToFavBtn").click(function(){var b=$(this),c={url:b.attr("data-src"),rebackPage:window.top.location.href,top:b.find("i").offset().top,left:b.find("i").offset().left};return GLOBAL.login.isLogin(GLOBAL.addTofavorite,c),b.addClass("addToFavBtnOn"),!1}),$(".gotoFullDetail").click(function(){window.top.location.href=DOMAIN+$(this).attr("data-url")}),function(){function a(){this.curColor=$.trim($("#js_property_color").find(".selected").find("a").attr("title")),this.curSize=$.trim($("#js_property_size").find(".selected").find("a").attr("title")),this.datas=ColorSize,this.usefulColor={},this.usefulSize={},this.ini()}a.prototype.getUsefulData=function(){for(var a=this,b=0,c=this.datas.length;c>b;b++){if(this.datas[b].size==this.curSize&&0==this.datas[b].isSale){var d=this.datas[b].color;a.usefulColor[d]=1}if(this.datas[b].color==this.curColor&&0==this.datas[b].isSale){var d=this.datas[b].size;a.usefulSize[d]=1}}},a.prototype.setStyle=function(){var a=$("#js_property_color").find("li"),b=$("#js_property_size").find("li"),c=this;return $.trim(this.curSize).length?($.each(a,function(a,b){var d=$(b);1!=c.usefulColor[$.trim(d.find("a").attr("title"))]?d.addClass("product_out"):d.removeClass("product_out")}),$.each(b,function(a,b){var d=$(b);1!=c.usefulSize[$.trim(d.find("a").attr("title"))]?d.removeClass("selected ").addClass("product_out"):d.removeClass("product_out")}),void 0):($("#js_property_size").closest("li").hide(),!1)},a.prototype.getGotToNewGoodsId=function(a,b){for(var c=0,d=this.datas.length;d>c;c++)if(this.datas[c].size==b&&this.datas[c].color==a&&0==this.datas[c].isSale)return this.datas[c].goodsId},a.prototype.gotoNewPage=function(a){var b=window.location.href,c=b.search(/goods_id=/)-0+"goods_id=".length,d=b.search(/&ids=/),e=b.replace(new RegExp(b.slice(c,d)),a);window.location.href=e},a.prototype.ini=function(){that=this,this.getUsefulData(),this.setStyle(),$("#js_property_color").on("click","li",function(){var a=$(this),b=$("#new_addcart"),c=$("#js_property_size").parent();if(a.siblings("li").removeClass("selected"),a.addClass("selected"),that.curColor=$.trim(a.find("a").attr("title")),delete that.usefulColor,delete that.usefulSize,that.usefulColor={},that.usefulSize={},that.getUsefulData(),that.setStyle(),$.trim(that.curSize).length)if(!a.hasClass("product_out")&&$("#js_property_size").find(".selected").length){var d=that.getGotToNewGoodsId(that.curColor,that.curSize);b.attr("gid","newGoodId"),that.gotoNewPage(d)}else b.attr("gid",""),c.addClass("hl-bg");else{for(var d="",e=0,f=that.datas.length;f>e;e++)if(that.datas[e].color==that.curColor){d=that.datas[e].goodsId;break}that.gotoNewPage(d)}}),$("#js_property_size").on("click","li",function(){var a=$(this),b=$("#new_addcart"),c=$("#js_property_size").parent();if($("#js_property_size").hasClass("disabled"))return!1;if(a.hasClass("product_out"))return!1;a.siblings("li").removeClass("selected"),a.addClass("selected"),that.curSize=$.trim(a.find("a").attr("title")),delete that.usefulColor,delete that.usefulSize,that.usefulColor={},that.usefulSize={},that.getUsefulData(),that.setStyle(),c.removeClass("hl-bg");var d=that.getGotToNewGoodsId(that.curColor,that.curSize);b.attr("gid","newGoodId"),that.gotoNewPage(d)})},$(".gf_property").find(".choose_wrap").length&&new a}();