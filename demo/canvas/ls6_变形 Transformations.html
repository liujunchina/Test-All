<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Ls6 Transformations 变形 - HTML5 Learn Test</title>

    <style type="text/css">
        body{padding: 0;margin: 0;background-color: #888;}
        img { display:none; }
        table { margin: 0 auto; }
        td { padding:15px; }
        #my-canvas{
            position: relative;
            margin: 50px auto;
            width: 500px;
            display: block;
            border: 1px solid #B6B6B6;
        }
    </style>
</head>
<body onload="darw();">
    <canvas id="my-canvas" width="300" height="300"></canvas>
</body>
<script type="text/javascript">
    function darw(){
        var canvas = document.getElementById("my-canvas");
        if(canvas.getContext){
            var ctx = canvas.getContext("2d");

            /**
            // save() restore();
            ctx.fillStyle = '#2E746F';
            ctx.fillRect(0,0,150,150);
            ctx.save();

            ctx.fillStyle = 'blue';
            ctx.fillRect(15,15,120,120);
            ctx.save();

            ctx.fillStyle = '#FFF';
            ctx.globalAlpha = 0.8;
            ctx.fillRect(30,30,90,90);
            ctx.restore();

            ctx.fillRect(45,45,60,60);

            ctx.restore();
            ctx.fillRect(60,60,30,30);
            ctx.save();

            ctx.fillStyle = 'red';
            ctx.fillRect(70,70,10,10);
            **/

            /**
            // translate
            ctx.fillRect(0,0,300,300);
            for(var i=0;i<3;i++){
                for(var j=0;j<3;j++){
                    ctx.save();
                    ctx.strokeStyle = '#9CFF00';
                    ctx.translate(50 + j *100,50 + i*100);
                    drawSpirograph(ctx,20*(j+2)/(j+1),-8*(i+3)/(i+1),10);
                    ctx.restore();
                }
            }

            function drawSpirograph(ctx,R,r,O){
                var x1 = R - O;
                var y1 = 0;
                var i = 1;
                ctx.beginPath();
                ctx.moveTo(x1,y1);
                do{
                    if(i > 20000) break;
                    var x2 = (R+r)*Math.cos(i*Math.PI/72) - (r+O)*Math.cos(((R+r)/r)*(i*Math.PI/72))
                    var y2 = (R+r)*Math.sin(i*Math.PI/72) - (r+O)*Math.sin(((R+r)/r)*(i*Math.PI/72))
                    ctx.lineTo(x2,y2);
                    x1 = x2;
                    y1 = y2;
                    i++;
                }while(x2 != R-O && y2 != 0 );
                ctx.closePath();
                ctx.stroke();
            }

            // ctx.rotate();
            ctx.translate(50,50);
            ctx.strokeStyle = '#9CFF00';

            ctx.save();
            ctx.strokeRect(10,10,100,20);

            ctx.restore();
            ctx.rotate(Math.PI / 2);
            ctx.strokeRect(10,10,100,20);

            // test;
            return;

            ctx.translate(75,75);
            for(var i=1;i<6;i++){
                ctx.save();
                ctx.fillStyle = 'rgb('+(51*i)+','+(255-51*i)+',255)';
                for(var j=0;j<i*6;j++){
                    ctx.rotate(Math.PI*2/(i*6));
                    ctx.beginPath();
                    ctx.arc(0,i*12.5,5,0,Math.PI*2,true);
                    ctx.fill();
                }
                ctx.restore();
            }

            // 缩放 scale()
            ctx.strokeStyle = '#fc0';
            ctx.lineWidth = 1.5;
            ctx.fillRect(0,0,300,300);

            ctx.save();
            ctx.translate(50,50);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(100,0);
            ctx.scale(0.75,0.75);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(133.333,0);
            ctx.scale(0.75,0.75);
            drawSpirograph(ctx,22,6,5);
            ctx.restore();

            ctx.strokeStyle = "#0cf";
            ctx.save()
            ctx.translate(50,150);
            ctx.scale(1,0.75);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(100,0);
            ctx.scale(1,0.75);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(100,0);
            ctx.scale(1,0.75);
            drawSpirograph(ctx,22,6,5);
            ctx.restore();

            ctx.strokeStyle = "#cf0";
            ctx.save()
            ctx.translate(50,250);
            ctx.scale(0.75,1);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(133.333,0);
            ctx.scale(0.75,1);
            drawSpirograph(ctx,22,6,5);

            ctx.translate(177.777,0);
            ctx.scale(0.75,1);
            drawSpirograph(ctx,22,6,5);
            ctx.restore();


            function drawSpirograph(ctx,R,r,O){
                var x1 = R - O;
                var y1 = 0;
                var i = 1;
                ctx.beginPath();
                ctx.moveTo(x1,y1);
                do{
                    if(i > 20000) break;
                    var x2 = (R+r)*Math.cos(i*Math.PI/72) - (r+O)*Math.cos(((R+r)/r)*(i*Math.PI/72))
                    var y2 = (R+r)*Math.sin(i*Math.PI/72) - (r+O)*Math.sin(((R+r)/r)*(i*Math.PI/72))
                    ctx.lineTo(x2,y2);
                    x1 = x2;
                    y1 = y2;
                    i++;
                }while(x2 != R-O && y2 != 0 );
                ctx.closePath();
                ctx.stroke();
            }
             **/

            // transform
            var sin = Math.sin(Math.PI/6);
            var cos = Math.cos(Math.PI/6);
            ctx.translate(200, 200);
            var c = 0;
            for (var i=0; i <= 12; i++) {
                c = Math.floor(255 / 12 * i);
                ctx.fillStyle = "rgb(" + c + "," + c + "," + c + ")";
                ctx.fillRect(0, 0, 100, 10);
                ctx.transform(cos, sin, -sin, cos, 0, 0);
            }

            ctx.setTransform(-1, 0, 0, 1, 200, 200);
            ctx.fillStyle = "rgba(255, 128, 255, 0.5)";
            ctx.fillRect(0, 50, 100, 100);

        }else{
            canvas.innerText = "你的浏览器不支持";
        }
    }
</script>
</html>