!function(e){"use strict";var t="003,吕孟欣,总经办;073,鲍飞,技术开发部;090,蔡秋金,人力行政部;101,曹方芳,产品运营部;069,曹雅茹,产品运营部;076,曾瑶敏,人力行政部;046,陈花,技术开发部;094,陈洁琼,产品运营部;017,陈娟,设计部;019,陈胜,技术开发部;088,程秀,商务部;111,戴述云,人力行政部;098,邓雨婷,产品运营部;035,杜果,设计部;056,杜莎莎,产品运营部;129,方增鸿,技术开发部;049,封美丽,商务部;02,高鹏,海外事业部;021,龚洪波,技术开发部;105,郭璋,海外事业部;023,胡云,第三方运营部;004,黄俊,技术开发部;042,黄绵卫,产品运营部;127,黄涛,财务部;083,黄义秦,设计部;096,黄逸明,产品运营部;006,李典意,技术开发部;054,李芳芳,财务部;037,李峰,供应链部;112,李行,产品运营部;051,李辉,产品运营部;071,李嘉莹,财务部;040,李洁,产品运营部;059,李明晶,产品运营部;016,李秋玉,商务部;079,李妍,产品运营部;103,李颖,商务部;036,利全佳,技术开发部;081,梁成进,技术开发部;022,梁铭,第三方运营部;032,林佩锋,第三方运营部;113,林伟令,第三方运营部;095,林増,产品运营部;116,刘巧灵,供应链部;085,刘文俊,产品运营部;102,刘文清,技术开发部;089,刘旭东,产品运营部;080,刘羽,产品运营部;091,柳俊,技术开发部;030,罗傲霜,产品运营部;070,罗成,技术开发部;025,罗静,技术开发部;117,吕阳,人力行政部;010,孟宪宝,供应链部;092,屈国洪,供应链部;038,申赋育,产品运营部;057,孙佳慧,人力行政部;044,万雪良,产品运营部;052,汪凌峰,产品运营部;107,汪庆文,技术开发部;124,王超辉,技术开发部;120,魏仁志,技术开发部;110,文健,海外事业部;064,文雯,技术开发部;029,吴佳坤,产品运营部;034,吴鹏飞,技术开发部;041,吴珊,第三方运营部;065,吴伟欣,商务部;009,吴畏,第三方运营部;045,吴优,设计部;075,谢斌,商务部;082,谢诚诚,设计部;128,徐林楠,设计部;109,徐美霞,产品运营部;028,许其龙,技术开发部;026,许庆亚,海外事业部;011,杨洪强,设计部;062,杨威,海外事业部;119,杨元,财务部;118,杨争芳,供应链部;123,尹利群,设计部;099,游如凤,海外事业部;047,余俊,产品运营部;031,张飞鹏,商务部;087,张飞云,商务部;005,张明哲,商务部;067,张喆,第三方运营部;020,赵少小,技术开发部;055,郑军,供应链部;027,钟浩,技术开发部;015,周强,技术开发部;063,周易里,产品运营部;106,周毅,海外事业部;024,卓邦友,产品运营部;066,邹丽,第三方运营部",n=Base.klass.create({elements:{"#j_controlBtn":"elBtn","#j_num_1":"elNum1","#j_num_2":"elNum2","#j_num_3":"elNum3","#j_resultWrap":"elResultWrap","#j_gameWrap":"elGameWrap"},events:{"click #j_controlBtn":"lotteryEvent","click #j-clearList":"clearListEvent","click #j_layerBg":"closeLayerEvent"},debug:!1,params:{animateSpeed:100,singleHeight:185,data:null,winningCookieId:"winningId",isPlaying:!1,playFlag:"active"},consoleLog:function(e){this.debug&&console.log(e)},init:function(){this.params.data=this._parseData(),this.consoleLog(this.params.data),this.specialEvent(),this.flush()},_parseData:function(){var e,n,i,a=[];if(t&&(e=String(t).split(";"),n=e.length,n>0))for(var s=0;n>s;s++)i=String(e[s]).split(","),a.push({id:i[0],name:i[1],department:i[2]});return a},flush:function(){},specialEvent:function(){var t=e("#j_wel2016"),n=this,i=1e3;t.one("click",function(){t.animate({bottom:0,right:0,width:"15%"},i),n.elGameWrap.fadeIn(2e3)})},lotteryEvent:function(e){return e.preventDefault(),this.params.isPlaying?!1:void(this.elBtn.hasClass(this.params.playFlag)?this.endLottery():this.startLottery())},clearListEvent:function(){this.clearWinningedUser(),alert("清除中奖纪录成功")},closeLayerEvent:function(){this.elResultWrap.fadeOut()},getWinningedUser:function(){return Base.cookie.getCookie(this.params.winningCookieId)},addWinningedUser:function(e){Base.cookie.setCookie({name:this.params.winningCookieId,value:(this.getWinningedUser()+","+e).replace(/^,*/,"")})},clearWinningedUser:function(){Base.cookie.setCookie({name:this.params.winningCookieId,value:""})},getRandomUser:function(e){function t(){var n=Math.floor(Math.random()*e);return this.consoleLog(n+"是中过奖"+(a.indexOf(i[n].id)>-1)),n=a.indexOf(i[n].id)>-1?t.call(this,e):n}var n,i=this.params.data,a=this.getWinningedUser();return e=e||i.length,a.split(",").length>=e?!1:(n=t.call(this),i[n])},_animate:function(t,n){function i(){t.css({top:0}).delay(n.delay).animate({top:s+"px"},l,n.easing,function(){n.isFree?(t.css({top:0}),n.delay=0,i()):n.endCall()})}function a(e){n.isFree=!1,"function"==typeof e&&(n.endCall=e)}n=e.extend({isFree:!0,singleSpeed:this.params.animateSpeed,easing:"linear",singleHeight:this.params.singleHeight,numberLength:10,delay:0,endCall:e.noop},n);var s=0-n.singleHeight*n.numberLength,l=+n.singleSpeed*n.numberLength;return i(),{start:i,end:a}},startAnimate:function(){this.animateNum1=this._animate(this.elNum1,{delay:400}),this.animateNum2=this._animate(this.elNum2,{delay:200}),this.animateNum3=this._animate(this.elNum3)},fixRandomNum:function(e){return 10>e?"00"+e:100>e?"0"+e:e},endAnimate:function(){function e(){clearTimeout(a),a=setTimeout(function(){n["animateNum"+i].end(function(){n["elNum"+i].css({top:0}),n._animate(n["elNum"+i],{isFree:!1,numberLength:+String(t).charAt(i-1),endCall:function(){i--,0!=i?e():setTimeout(function(){n._showResult(),n.params.isPlaying=!1},l)}})})},s)}var t=this.fixRandomNum(+this.winUser.id),n=this,i=3,a=null,s=700,l=1e3;n.params.isPlaying=!0,e()},_showResult:function(){this.elResultWrap.find(".j_id").text("MS0"+this.winUser.id),this.elResultWrap.find(".j_department").text(this.winUser.department),this.elResultWrap.find(".j_name").text(this.winUser.name),this.elResultWrap.fadeIn()},startLottery:function(){this.elBtn.addClass(this.params.playFlag),this.startAnimate()},endLottery:function(){var e;this.elBtn.removeClass(this.params.playFlag),this.winUser=e=this.getRandomUser(),0!=e?(this.consoleLog("当前中奖用户:"),this.consoleLog(e),this.addWinningedUser(e.id),this.endAnimate()):alert("所有人都中过奖了")}});e(function(){new n})}(jQuery);