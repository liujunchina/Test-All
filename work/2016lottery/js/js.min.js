!function(n){"use strict";var t=Base.klass.create({elements:{"#j-btn":"elBtn"},events:{"click #j-btn":"lotteryEvent","click #j-clearList":"clearListEvent"},debug:!0,params:{data:null,winningCookieId:"winningId",isPlaying:!1,playFlag:"active"},consoleLog:function(n){this.debug&&console.log(n)},init:function(){this.params.data=this._parseData(),this.consoleLog(this.params.data),this.flush()},_parseData:function(){var n,t,i,e=[];if(USERDATA&&(n=String(USERDATA).split(";"),t=n.length,t>0))for(var a=0;t>a;a++)i=String(n[a]).split(","),e.push({id:i[0],name:i[1],department:i[2]});return e},flush:function(){},lotteryEvent:function(n){return n.preventDefault(),this.params.isPlaying?!1:void(this.elBtn.hasClass(this.params.playFlag)?this.endLottery():this.strartLottery())},clearListEvent:function(){this.clearWinningedUser(),alert("清楚中奖纪录成功")},getWinningedUser:function(){return Base.cookie.getCookie(this.params.winningCookieId)},addWinningedUser:function(n){Base.cookie.setCookie({name:this.params.winningCookieId,value:(this.getWinningedUser()+","+n).replace(/^,*/,"")})},clearWinningedUser:function(){Base.cookie.setCookie({name:this.params.winningCookieId,value:""})},getRandomUser:function(n){function t(){var i=Math.floor(Math.random()*n);return this.consoleLog(i+"是中过奖"+(a.indexOf(e[i].id)>-1)),i=a.indexOf(e[i].id)>-1?t.call(this,n):i}var i,e=this.params.data,a=this.getWinningedUser();return n=n||e.length,i=t.call(this),e[i]},_aniamte:function(){},startAniamte:function(){},endAnimate:function(){},strartLottery:function(){this.elBtn.addClass(this.params.playFlag)},endLottery:function(){this.elBtn.removeClass(this.params.playFlag);var n=this.getRandomUser();n&&(this.consoleLog("当前中奖用户:"),this.consoleLog(n),this.consoleLog("\n"),this.addWinningedUser(n.id))}});n(function(){new t})}(jQuery);